---
import { twMerge } from "tailwind-merge";
import MoreReviewsList from "./MoreReviewsList.astro";
import type { Review } from "@/api/reviews";

interface Props {
  review: Pick<Review, "moreCastAndCrew" | "moreCollections" | "moreReviews">;
  class?: string;
}

const { review, class: className } = Astro.props;

function leadTextForCreditKind(creditKind: string): string {
  switch (creditKind) {
    case "director": {
      return "More directed by";
    }
    case "performer": {
      return "More with";
    }
    case "writer": {
      return "More written by";
    }
    default: {
      throw new Error(`Unknown credit kind ${creditKind}`);
    }
  }
}
---

<div
  class={twMerge(
    "flex flex-col items-center gap-y-12 bg-default tablet:bg-subtle tablet:pb-32 tablet:pt-8 desktop:gap-y-24",
    className
  )}
>
  {
    review.moreCastAndCrew.map((castAndCrewMember) => (
      <MoreReviewsList
        leadText={leadTextForCreditKind(castAndCrewMember.creditKind)}
        linkText={castAndCrewMember.name}
        linkTarget={`/cast-and-crew/${castAndCrewMember.slug}`}
        items={castAndCrewMember.titles}
      />
    ))
  }

  {
    review.moreCollections.map((collection) => (
      <MoreReviewsList
        leadText="More"
        linkText={collection.name}
        linkTarget={`/collections/${collection.slug}`}
        items={collection.titles}
      />
    ))
  }

  <MoreReviewsList
    leadText="More"
    linkText="Reviews"
    linkTarget="/reviews/"
    items={review.moreReviews}
  />
</div>
